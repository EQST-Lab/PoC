# Advanced REST Client v.17.0.9 (Stored XSS)
> A Proof-Of-Concept for CVE-2024-25503 vulnerability
<br>

## 1. Description
A cross-site scripting vulnerability in Advanced REST Client v.17.0.9 enables remote attackers to execute arbitrary code within the editing details parameters of the new project function by utilizing a crafted script.
<br><br>

## 2. Attack Vectors
This vulnerability occurs when the attacker maliciously stores the 'Stored XSS' script in the description (markdown) of the project created, passes it to the victim, and runs the shared project on the victim's PC with the ARC App.
<br><br>

## 3. Proof-of-Concepts (POC)

#### Step 1) Click on the '+ADD A PROJECT' button on the third tab after running the Advanced REST Client.
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/a0931cb9-a4e9-4271-b308-1cf0bc96e5dc)
<br><br>

#### Step 2) Click the 'Open details' tab to view the created project.
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/f961c974-7394-44d8-9883-060714c3030a)
<br><br>

#### Step 3) Click on the 'Edit details' tab in the created New Project.
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/00450fdc-809c-4350-b35a-061d911e6e74)
<br><br>

#### Step 4) Attacker writes 'XSS script' and clicks 'SAVE' button.

```html
<!--Used 'XSS script' for information leakage-->
<img src=# onerror="alert(document.location)">

<!--Another 'XSS script' for phishing-->
<img src=# onerror="alert(document.location)">
```
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/37824aa4-55e1-4c3d-9c41-1d9b922c0785)
<br><br>

#### Step 5) When opening a project, a 'XSS script' may generate an alert(information leakage)
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/a98d69e9-165d-48d4-8197-843efd2d5856)
<br><br>

#### or load an attacker's page(phishing).
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/d1979ea6-c4a7-4e4c-947c-c646608a72f8)
<br><br>

#### Step 6) Projects created by attackers can be exported through the 'Export project' function.
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/839795c6-97ac-4998-a3b9-132aeca1ea72)
<br><br>

#### Step 7) Attacker names the project and clicks the 'EXPORT' button to export the project where the 'XSS script' is stored.
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/f2ecf91c-251b-4b9a-a043-a902da9fe985)
<br><br>

#### Step 8) This app also has the ability to import a project.
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/2dda9a18-4d16-428d-965b-d8734cd4198e)
<br><br>

#### Step 9) Victim selects 'import all versions of ARC data' from the top tab to open the projectreceived from the attacker.
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/9704bbf7-b028-4d13-9301-34b4eedfb70f)
<br><br>

#### Step 10) When clicking a 'SELECT FILE' button for victim to open malicious project file containing 'XSS script'.
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/059db63b-641f-4e17-86d0-77b7d7aadb30)
<br><br>

#### Step 11) After the file selection is completed, click the 'IMPORT DATA' button to importsuccessfully.
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/0b939870-f2c9-487a-9a2c-2e226fb8eeb2)
<br><br>

#### Step 12) Imported file runs and attacker's 'Stored XSS script' runs on victim's 'Advanced RESTClient (ARC) App'.
![image](https://github.com/EQSTLab/Bugbounty/assets/67315168/908ae455-cc6f-4cdf-a234-70148f36341f)
<br><br>

## 4. Additional Information
* If the victim executes a project that includes malicious payloads shared by the attacker, it is dangerous because the victim cannot immediately notice the payload.
  
* For example, this vulnerability can be used to steal sensitive information or perform malicious behavior by reading a user's browser URL.
  
* You can also perform phishing attacks by redirecting users to other sites. Be careful if an XSS vulnerability is exploited in a phishing attack, which can lead to external exposure of sensitive information.
